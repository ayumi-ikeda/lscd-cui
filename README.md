

## lscd (Directory Changer) コマンド仕様書

### 1. 概要

`whiptail` によるメニュー選択インターフェースを用い、カレントディレクトリ直下のサブディレクトリへ視覚的に移動するためのツール。
特に日本語ディレクトリ名や長い名称を持つディレクトリへの移動において、入力の手間を省き、直感的な操作を提供する。

### 2. 機能要件

* **ディレクトリ一覧の取得:**
* 実行時に `ls` 互換のオプション（例: `-a`）を受け付け、表示対象を制御する。
* ただし、メニュー表示を阻害する詳細情報（パーミッションやサイズ等）は除外し、ディレクトリ名のみを抽出する。


* **エラーハンドリング:**
* カレントディレクトリにサブディレクトリが存在しない場合、`whiptail` のメッセージボックス（OKボタン付き）で「ディレクトリがありません」と警告を表示し、コマンドを終了する。


* **サブシェルの起動:**
* ユーザーがディレクトリを選択すると、そのディレクトリへ `cd` した状態で新しいシェルを起動する。
* **シェルの選択:** 親プロセスで使用していたシェル（`bash`, `zsh` 等）を判別し、同じ種類のシェルを起動する。


* **ユーザーへの視覚的フィードバック:**
* **プロンプト:** 起動した子プロセスのプロンプト頭に、**黄色**で `[lscd]` という接頭辞を付与する。
* **終了ガイド:** 子プロセス起動直後の標準出力に、親プロセスに戻るためのガイド（「終了は Ctrl+D」等）を表示する。



### 3. インターフェース仕様

#### コマンドライン引数

| 引数 / オプション | 内容 |
| --- | --- |
| `[ls OPTIONS]` | `-a`（隠しファイル表示）など、標準的な `ls` コマンドのフラグを継承する。 |
| `-h`, `--help` | 使い方を表示して終了する。 |
| `-v`, `--version` | バージョン情報を表示して終了する。 |

#### 表示（TUI）

1. **選択画面:** `whiptail --menu` を使用。
2. **エラー画面:** `whiptail --msgbox` を使用。

### 4. 実行フロー図

1. **初期化:** 実行時の引数を解析し、対象ディレクトリをリストアップ。
2. **判定:**
* 対象ゼロ → **エラーダイアログ表示**後、終了。
* 対象あり → **メニュー表示**。


3. **アクション:**
* キャンセル選択 → 終了。
* ディレクトリ選択 → 対象へ `cd` し、環境変数 `PS1` を調整してシェルを起動。


4. **終了:** ユーザーが `Ctrl+D` または `exit` を入力すると、子プロセスが終了し、元のディレクトリ（親シェル）に戻る。
