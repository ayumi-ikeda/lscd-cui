# コマンド実装仕様書：lscd (v0.0.1)

## 1. コマンド概要

`whiptail` を使用したTUIメニューからサブディレクトリを選択し、そのディレクトリへ移動（cd）した状態で新しいシェル（子プロセス）を起動するシェルスクリプト。

## 2. ターゲット環境

* **OS:** Ubuntu (WSL含む)
* **依存コマンド:** `whiptail`, `bash`, `zsh` 等のPOSIXシェル

## 3. 詳細仕様

### A. ディレクトリ一覧の取得ロジック（重要）

* **対象:** カレントディレクトリ直下の「ディレクトリ」のみ。
* **フィルタリング:** * `ls` の引数（`$@`）をそのまま受け継ぐ（例: `lscd -a` で隠しディレクトリを表示）。
* **不具合対策:** `ls -d` ではなく、`ls -F` 等でディレクトリを判別し、末尾のスラッシュ（/）を指標に抽出すること。
* 自身（`.`）や親（`..`）はメニューのノイズになるため除外する。
* `whiptail` に渡すため、余計なカラム（パーミッション、サイズ等）は一切含めず、純粋な名前のみのリストを作成すること。

### B. エラーハンドリング

* サブディレクトリが1つも見つからない場合、`whiptail --msgbox` を使用して以下の警告を表示し、正常終了（exit 0）する。
* メッセージ：「ディレクトリがありません」

### C. シェル起動とプロンプト制御

* **移動:** ユーザーが選択したディレクトリへ `cd` する。
* **シェルの継承:** 現在の実行シェル（`$SHELL` 環境変数または `ps` コマンドで判定）と同じシェルを起動する。
* **プロンプトの変更:**
* 新しく起動するシェルのプロンプト（PS1）の先頭に、**黄色**で `[lscd]` を付与する。
* 文字色のエスケープシーケンス：`\e[1;33m` (Yellow)

* **終了ガイド:** 子プロセス起動時、標準出力に「終了して戻るには Ctrl+D または exit」というガイドを表示する。

## 4. インターフェース

### ヘルプメッセージ

```text
Usage: lscd [ OPTION ]

  -h, --help        使い方を表示して終了する
  -v, --version     バージョン情報を表示して終了する
  [ls OPTIONS]      lsコマンドのオプションを継承（例: -a で隠しディレクトリ表示）

```

## 5. 実装時の注意点

* `whiptail` の戻り値（キャンセルボタン等）を適切にハンドリングし、何も選択されなかった場合はシェルを起動せずに終了すること。
* スペースを含むディレクトリ名でも正常に動作するように、変数のクォーティングを徹底すること。
